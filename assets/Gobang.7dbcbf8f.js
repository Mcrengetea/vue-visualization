var n=Object.defineProperty;var f=(a,t,e)=>t in a?n(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var h=(a,t,e)=>(f(a,typeof t!="symbol"?t+"":t,e),e);import{d as u,l as c,s as d,x as p,o as m,c as F,a as C,i as _}from"./index.69065d26.js";class b{constructor(t){h(this,"dom");h(this,"context");h(this,"chessColor");h(this,"step");h(this,"map");h(this,"mode");h(this,"chessboardSize");h(this,"currentPlayer");h(this,"gameOver");this.dom=t,this.context=t.getContext("2d"),this.chessColor=["#000","#fff"],this.step=0,this.map=[],this.mode=[[1,0],[0,1],[1,1],[1,-1]],this.chessboardSize=15,this.currentPlayer=0,this.gameOver=!1}init(){this.initMap(),this.drawChessboard(),this.dom.addEventListener("click",this.play.bind(this))}initMap(){for(let t=0;t<this.chessboardSize;t++){this.map[t]=[];for(let e=0;e<this.chessboardSize;e++)this.map[t][e]=-1}}drawChessboard(){if(this.context!==null){this.context.clearRect(0,0,this.dom.width,this.dom.width);for(let t=0;t<this.chessboardSize;t++)this.context.beginPath(),this.context.moveTo(15,t*30+15),this.context.lineTo(435,t*30+15),this.context.moveTo(t*30+15,15),this.context.lineTo(t*30+15,435),this.context.stroke();this.context.fillStyle="#fff",this.context.fillRect(450,0,150,450),this.context.fillStyle="#000",this.context.font="20px '\u5FAE\u8F6F\u96C5\u9ED1'",this.context.fillText("\u5F53\u524D\u843D\u5B50\u65B9",470,100),this.context.font="16px '\u5FAE\u8F6F\u96C5\u9ED1'",this.context.fillText("\u9ED1\u68CB",505,150),this.fillRoundRect(this.context,470,300,110,40,8,"#66ccff"),this.context.fillStyle="#000",this.context.font="20px '\u5FAE\u8F6F\u96C5\u9ED1'",this.context.fillText("\u91CD\u65B0\u5F00\u59CB",485,325)}}drawChess(t,e,s){this.context!==null&&(this.context.fillStyle=this.chessColor[s],this.map[t][e]=s,this.context.beginPath(),this.context.arc(t*30+15,e*30+15,12,0,Math.PI*2,!1),this.context.fill(),this.context.stroke(),this.drawGameInfo(this.context))}drawGameInfo(t){t.fillStyle="#fff",t.fillRect(480,130,80,40),t.fillStyle="#000",t.font="16px '\u5FAE\u8F6F\u96C5\u9ED1'";let e=this.currentPlayer===0?"\u767D\u68CB":"\u9ED1\u68CB";t.fillText(e,505,150),this.gameOver&&(e=this.currentPlayer===0?"\u9ED1\u68CB":"\u767D\u68CB",e+="\u80DC\u5229\uFF01",t.fillStyle="#fff",t.fillRect(450,0,150,200),t.fillStyle="#000",t.font="20px '\u5FAE\u8F6F\u96C5\u9ED1'",t.fillText(e,480,150))}fillRoundRect(t,e,s,o,l,i,r){o<2*i&&(i=o/2),l<2*i&&(i=l/2),t.beginPath(),t.moveTo(e+i,s),t.arcTo(e+o,s,e+o,s+l,i),t.arcTo(e+o,s+l,e,s+l,i),t.arcTo(e,s+l,e,s,i),t.arcTo(e,s,e+o,s,i),t.stroke(),t.fillStyle=r||"#000",t.fill()}judgeWinner(t,e,s,o){let l=0;for(let i=1;i<5;i++)if(this.map[t+i*o[0]])if(this.map[t+i*o[0]][e+i*o[1]]===s)l++;else break;for(let i=1;i<5;i++)if(this.map[t-i*o[0]])if(this.map[t-i*o[0]][e-i*o[1]]===s)l++;else break;l>=4&&(this.gameOver=!0,this.drawGameInfo(this.context))}play(t){let e=Math.floor(t.offsetX/30),s=Math.floor(t.offsetY/30);e>=0&&s>=0&&e<15&&s<15&&this.map[e][s]===-1&&!this.gameOver&&(this.currentPlayer=this.step%2,this.drawChess(e,s,this.currentPlayer),this.map[e][s]=this.currentPlayer,this.judgeWinner(e,s,this.currentPlayer,this.mode[0]),this.judgeWinner(e,s,this.currentPlayer,this.mode[1]),this.judgeWinner(e,s,this.currentPlayer,this.mode[2]),this.judgeWinner(e,s,this.currentPlayer,this.mode[3]),this.step++),this.restart(t)}restart(t){t.offsetX>=470&&t.offsetX<=580&&t.offsetY>=300&&t.offsetY<=340&&(this.gameOver=!1,this.initMap(),this.drawChessboard())}dispose(){this.dom.removeEventListener("click",this.play)}}const v={class:"box"},x=u({__name:"Gobang",setup(a){const t=c();let e=null;return d(()=>{e=new b(t.value),e.init()}),p(()=>{e.dispose(),e=null}),(s,o)=>(m(),F("div",v,[C("canvas",{class:"chessboard",ref_key:"chessboard",ref:t,width:"600",height:"450"},"\u5F53\u524D\u6D4F\u89C8\u5668\u4E0D\u652F\u6301canvas\uFF0C\u8BF7\u66F4\u6362\u6D4F\u89C8\u5668\u4F7F\u7528\uFF01",512)]))}});const g=_(x,[["__scopeId","data-v-2e3cd4b3"]]);export{g as default};
